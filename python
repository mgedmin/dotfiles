# Python startup script.            vim: set ft=python :
# from http://www.norvig.com/python-iaq.html
# also see Tarek Ziade's _Expert_Pythom_Programming_ page 19
import os, sys

# Coloured prompt
if os.getenv('TERM') in ('xterm', 'vt100', 'rxvt', 'Eterm', 'putty'):
    try:
        import readline
    except ImportError:
        sys.ps1 = '\033[0;32m>>> \033[0m'
        sys.ps2 = '\033[0;32m... \033[0m'
    else:
        sys.ps1 = '\001\033[0;32m\002>>> \001\033[0m\002'
        sys.ps2 = '\001\033[0;32m\002... \001\033[0m\002'

# Completion!
try:
    import readline
except ImportError:
    print("Module readline not available.")
else:
    # persistent history
    histfile = os.path.expanduser('~/.pythonhistory')
    try:
        readline.read_history_file(histfile)
    except IOError:
        pass
    import atexit
    def write_history(readline=readline, histfile=histfile):
        try:
            readline.write_history_file(histfile)
        except IOError:
            # root, nfs-mounted home with root_squash -> permission denied
            pass
    atexit.register(write_history)
    del histfile, atexit, write_history
    # tab completion
    try:
        sys.path.append(os.path.join(os.getenv('HOME'), 'src', 'rlcompleter2'))
        import rlcompleter2
        rlcompleter2.setup()
        del rlcompleter2
    except ImportError:
        import rlcompleter
        readline.parse_and_bind("tab: complete")
        del rlcompleter
    del readline

del sys
del os
